<!DOCTYPE html>
<html class="no-js  page-29 app-E-DISTRICT-MANAGER-APPLICATION" lang="en">

<head>
    <meta http-equiv="x-ua-compatible" content="IE=edge" />
    <meta charset="utf-8">
    <title>Public Petitions</title>
    <link rel="stylesheet" href="../assets/css/oj-redwood-notag-min.css" type="text/css">
    <link rel="stylesheet" href="../assets/css/Core.min.css" type="text/css">
    <link rel="stylesheet" href="../assets/css/Theme-Standard.min.css" type="text/css">
    <link rel="stylesheet" href="../assets/css/font-apex.min.css" type="text/css">
    <link rel="stylesheet" href="../assets/css/Core-theme.min.css" type="text/css">
    <link rel="stylesheet" href="../assets/css/custom.min.css" type="text/css">
    <link rel="stylesheet" href="../assets/css/theme.css" type="text/css">
    <link rel="stylesheet" href="../assets/css/commonMenu.css" type="text/css">
    <link href="../assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="../assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
    <link href="../assets/vendor/datatable/css/dataTables.css" rel="stylesheet">
    <link rel="stylesheet" href="../assets/vendor/datatable/dataTables.bootstrap5.min.css">
    <!-- Vendor CSS Files -->
    <link href="../assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="../assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">

    <link href="../assets/vendor/toastr/toastr.min.css" rel="stylesheet">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="-1" />
    <meta http-equiv="Cache-Control" content="no-cache" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <style>
        #t_Body_nav {
            width: 100% !important;
        }
    </style>
</head>

<body
    class="t-PageBody t-PageBody--hideLeft t-PageBody--hideActions no-anim t-PageTemplate--standard   apex-side-nav apex-icons-fontapex apex-theme-vita-copy-1"
    id="t_PageBody">
    <a href="#main" id="t_Body_skipToContent">Skip to Main Content</a>
    <form>
        <header class="t-Header" id="t_Header" role="banner">

            <div class="t-Header-branding">
                <div class="t-Header-controls">
                    <button class="t-Button t-Button--icon t-Button--header t-Button--headerTree"
                        aria-label="Main Navigation" title="Main Navigation" id="t_Button_navControl"
                        type="button"><span class="t-Header-controlsIcon" aria-hidden="true"></span></button>
                </div>
                <div class="t-Header-logo">
                    <!-- <a href="&#x2F;ords&#x2F;r&#x2F;edmdev&#x2F;e-district-manager-application&#x2F;home?session=114048261149373" class="t-Header-logo-link"><span class="apex-logo-text">e-District Manager Portal</span></a>-->
                    <!-- <a href="&#x2F;ords&#x2F;r&#x2F;edmdev&#x2F;e-district-manager-application&#x2F;home?session=114048261149373" class="t-Header-logo-link">Toll Free Support : +91 9042370430</a>-->
                    <P class="t-Header-logo-link">TNEGA</P>

                </div>
                <div class="t-Header-navBar">
                    <div class="t-Header-navBar--start"></div>
                    <div id="globalHeader"></div>

                    <div class="t-Header-navBar--end"></div>
                </div>
            </div>
            <div class="t-Header-nav"></div>
        </header>
        <div class="t-Body">
            <div class="t-Body-nav" id="t_Body_nav" role="navigation" aria-label="Application">
                <div class="a-TreeView t-TreeNav js-addActions js-defaultCollapsed js-navCollapsed--hidden t-TreeNav--classic"
                    id="t_TreeNav" data-id="29_tree" aria-label="Main Navigation">
                    <ul id="commonMenuContainer"></ul>

                </div>
            </div>
            <div class="t-Body-main">
                <div class="t-Body-title" id="t_Body_title"></div>
                <div class="t-Body-content" id="t_Body_content">
                    <main id="main" class="t-Body-mainContent">
                        <span id="APEX_SUCCESS_MESSAGE" data-template-id="13879136713391167_S"
                            class="apex-page-success u-hidden"></span><span id="APEX_ERROR_MESSAGE"
                            data-template-id="13879136713391167_E" class="apex-page-error u-hidden"></span>
                        <div class="t-Body-fullContent"></div>
                        <div class="t-Body-contentInner">
                            <div class="container">
                                <div class="col col-2 float-end m-2">
                                    <button id="createBtn" class="btn btn-success">
                                        <i class="t-Icon t-Icon--left fa fa-plus-circle-o fa-anim-flash"
                                            style="margin-top: 5px;"></i>Create
                                    </button>
                                </div>
                            </div>
                            <div id="R53337887249653684_content" class="a-IRR-content ">
                                <div id="R53337887249653684_dialog_js" class="a-IRR-dialogBody" style="display:none;">
                                </div><input type="hidden" id="R53337887249653684_worksheet_id"
                                    value="53338015490653684" />
                                <input type="hidden" id="R53337887249653684_app_user" value="6380988375" />
                                <input type="hidden" id="R53337887249653684_report_id" value="53377642359796983" />
                                <input type="hidden" id="R53337887249653684_view_mode" value="REPORT" />


                                <div role="region" aria-label="Chart&#x20;view&#x20;of&#x20;All&#x20;Request"
                                    id="R53337887249653684_chart" class="a-IRR-chartView"></div>
                                <div role="region" aria-label="Group&#x20;by&#x20;view&#x20;of&#x20;All&#x20;Request"
                                    id="R53337887249653684_group_by" class="a-IRR-groupByView"></div>
                                <div role="region" aria-label="Pivot&#x20;view&#x20;of&#x20;All&#x20;Request"
                                    id="R53337887249653684_pivot" class="a-IRR-pivotView"></div>
                                <div role="region" aria-label="Data&#x20;view&#x20;of&#x20;All&#x20;Request"
                                    id="R53337887249653684_data_panel" class="a-IRR-reportView">
                                    <div class="a-IRR-tableContainer">
                                        <table id="pressReleaseTable" class="display" style="width:100%">
                                            <thead>
                                                <tr>
                                                    <th>Actions</th>
                                                    <th>SI no</th>
                                                    <th>Petition Date</th>
                                                    <th>Citizen Name</th>
                                                    <th>Mobile Number</th>
                                                    <th>Issue Related to</th>
                                                    <th>Issue handled by</th>
                                                    <th>Remarks</th>
                                                    <th>Issue Type</th>
                                                </tr>
                                            </thead>
                                            <tbody></tbody>
                                        </table>
                                    </div>

                                </div>
                            </div>
                        </div>
                </div>
                <div role="dialog" aria-label="Column&#x20;Actions" aria-modal="true" class="a-IRR-sortWidget"
                    id="R53337887249653684_sort_widget" style="display:none;">
                    <h1 class="u-vh" aria-roledescription="Visually&#x20;hidden&#x20;dialog&#x20;title">
                        Column Actions</h1>
                    <ul role="toolbar" class="a-IRR-sortWidget-actions" id="R53337887249653684_sort_widget_actions">
                        <li role="none" class="a-IRR-sortWidget-actions-item"
                            id="R53337887249653684_sort_widget_action_up">
                            <button class="a-Button a-IRR-button a-IRR-sortWidget-button" type="button"
                                title="Sort&#x20;Ascending" aria-label="Sort&#x20;Ascending" data-option="up"><span
                                    aria-hidden="true" class="a-Icon icon-irr-sort-asc"></span></button>
                        </li>
                        <li role="none" class="a-IRR-sortWidget-actions-item"
                            id="R53337887249653684_sort_widget_action_down">
                            <button class="a-Button a-IRR-button a-IRR-sortWidget-button" type="button"
                                title="Sort&#x20;Descending" aria-label="Sort&#x20;Descending" data-option="down"><span
                                    aria-hidden="true" class="a-Icon icon-irr-sort-desc"></span></button>
                        </li>
                        <li role="none" class="a-IRR-sortWidget-actions-item"
                            id="R53337887249653684_sort_widget_action_hide">
                            <button class="a-Button a-IRR-button a-IRR-sortWidget-button" type="button"
                                title="Hide&#x20;Column" aria-label="Hide&#x20;Column" data-option="hide"><span
                                    aria-hidden="true" class="a-Icon icon-irr-remove-col"></span></button>
                        </li>
                        <li role="none" class="a-IRR-sortWidget-actions-item"
                            id="R53337887249653684_sort_widget_action_break">
                            <button class="a-Button a-IRR-button a-IRR-sortWidget-button" type="button"
                                title="Control&#x20;Break" aria-label="Control&#x20;Break" data-option="break"><span
                                    aria-hidden="true" class="a-Icon icon-irr-control-break"></span></button>
                        </li>
                        <li role="none" class="a-IRR-sortWidget-actions-item"
                            id="R53337887249653684_sort_widget_action_help">
                            <button class="a-Button a-IRR-button a-IRR-sortWidget-button" type="button" title="Help"
                                aria-label="Help" data-option="help" aria-pressed="false"><span aria-hidden="true"
                                    class="a-Icon icon-irr-help"></span></button>
                        </li>
                        <li role="none" class="a-IRR-sortWidget-actions-item"
                            id="R53337887249653684_sort_widget_action_computation"><button
                                class="a-Button a-IRR-button a-IRR-sortWidget-button" type="button" title="Compute"
                                aria-label="Compute" data-option="computation"><span aria-hidden="true"
                                    class="a-Icon icon-irr-calculator"></span></button></li>
                    </ul>
                    <div role="region" aria-label="Help" class="a-IRR-sortWidget-help"
                        id="R53337887249653684_sort_widget_help"></div>
                    <div role="search" class="a-IRR-sortWidget-search" id="R53337887249653684_sort_widget_search"><label
                            for="R53337887249653684_sort_widget_search_field"><span aria-hidden="true"
                                class="a-IRR-sortWidget-searchLabel"></span><span
                                class="u-vh">Search</span></label><input
                            id="R53337887249653684_sort_widget_search_field" class="a-IRR-sortWidget-searchField"
                            type="text" placeholder="Filter..." />
                        <div role="group" aria-label="Filter&#x20;suggestions" class="a-IRR-sortWidget-rows"
                            id="R53337887249653684_sort_widget_rows"></div>
                    </div>
                </div>
            </div>


        </div>
        </div>
        </div>
        </div>
        </div>
        </div>
        </div>
        </div>
        </div>
        </main>
        <footer class="t-Footer" id="t_Footer" role="contentinfo">
            <div class="t-Footer-body">
                <div class="t-Footer-content"></div>
                <div class="t-Footer-apex">
                    <div class="t-Footer-version"> </div>
                    <div class="t-Footer-customize"></div>

                </div>
            </div>
            <div class="t-Footer-top">
                <a href="#top" class="t-Footer-topButton" id="t_Footer_topButton" title="Start of page"
                    aria-label="Start of page"><span class="a-Icon icon-up-chevron" aria-hidden="true"></span></a>
            </div>
        </footer>
        </div>
        </div>
        </div>
        <div class="t-Body-inlineDialogs" id="t_Body_inlineDialogs"></div><input type="hidden"
            id="pPageFormRegionChecksums" value="&#x5B;&#x5D;">
        <input type="hidden" id="pPageItemsRowVersion" value="" /><input type="hidden" id="pPageItemsProtected"
            value="UDI5X1BSSU9SSVRZ&#x2F;XIbU9sp6PSH5V9rihhG_SI1DK4EDmHA7AUwSg78x7b2eRR9N7JplIsD6xGIS79bThyaPTVHBkqAUYoBmQTv1MQ" />
    </form>
    <!-- jQuery -->
    <script src="../assets/js/jquery-3.6.0.min.js"></script>
    <script src="../assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

    <!-- DataTables -->
    <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
    <script src="../assets/js/widget.treeView.min.js"></script>
    <script type="module" src="../assets/js/commonMenu.js"></script>
    <script src="../assets/js/widget.interactiveReport.min.js"></script>
    <script src="../assets/js/widget.iconList.min.js"></script>
    <script src="../assets/js/widget.stickyTableHeader.min.js"></script>
    <script src="../assets/js/widget.stickyWidget.min.js"></script>
    <script src="../assets/js/item.Colorpicker.min.js"></script>
    <script src="../assets/js/jetCommonBundle.min.js"></script>
    <script src="../assets/js/chartBundle.min.js"></script>
    <script src="../assets/js/toastUtil.js"></script>
    <script type="module" src="../assets/js/dataTableUtil.js"></script>
    <script src="../assets/js/crypto-js.min.js"></script>
    <script src="../assets/js/theme42.min.js"></script>
    <script src="../assets/js/global.js"></script>
    <script src="../assets/js/encrypt_decrypt.js"></script>
    <script src="../assets/js/globalHeader.js"></script>

    <script>
        $(document).ready(function () {
            console.log('jQuery loaded?', typeof jQuery !== 'undefined');
            console.log('DataTable loaded?', typeof $.fn.DataTable !== 'undefined'); // should be true

            $('#pressReleaseTable').DataTable();
        });
    </script>

    <script>
        console.log("✅ DataTables loaded?", typeof $.fn.DataTable); 
    </script>
    <script>
        $('#t_Button_navControl').on('click', function () {
            $('#t_Body_nav').toggle();
        });

    </script>



    <script type="module">
        import { encryptData } from '../assets/js/encrypt_decrypt.js';
        let dataTableRef;
        $(document).ready(function () {
            debugger

            var userId = localStorage.getItem('userId');
            const langSwitch = 'en';
            const apiUrl = "https://tngis.tnega.org/lcap_api/edm/v1/commonfunction";
            const secretKey = 'V7gN4dY8pT2xB3kRz';


            const payload = {
                action: "function_call",
                function_name: "hdo_public_pettition_fn",
                params: {

                    // userid: "EDM0416",
                }
            }
            // const encryptedPayload = CryptoJS.AES.encrypt(JSON.stringify(payload), secretKey).toString();//check

            loadDataToTable({
                tableId: 'pressReleaseTable',
                apiUrl,
                httpMethod: 'POST',
                payload: encryptData(payload),
                rowBuilder: (item) => {
                    const applicationinfo = {
                        petition_id: item.petition_id,
                        petition_date: item.petition_date,
                        citizen_name: item.citizen_name,
                        issue_related_to: item.issue_related_to,
                        remarks: item.remarks,
                        issue_handled_by: item.issue_handled_by,
                        issue_type: item.issue_type,
                        mobile_number: item.mobile_number,

                    };
                    const encodedDetails = btoa(JSON.stringify(applicationinfo));

                    const status = btoa(String(item.request_status));
                    return `
    <tr>
    <td class="u-tL">
        <a data-id="${item.petition_id}" id="open-modal-btn" href="publicpetitions-info.html?details=${encodedDetails}&status=${status}">
       <i class="bi bi-pencil-square"></i>
        </a>
        </td>
      <td class="u-tC">${item.sl_no || 'N/A'}</td>
      <td class="u-tC">${item.petition_date || 'N/A'}</td>
      <td class="u-tC">${item.citizen_name || 'N/A'}</td>
      <td class="u-tC">${item.mobile_number || 'N/A'}</td>
      <td class="u-tC">${item.issue_related_to || 'N/A'}</td>
      <td class="u-tC">${item.issue_handled_by || 'N/A'}</td>
      <td class="u-tC">${item.remarks || 'N/A'}</td>
      <td class="u-tC">${item.issue_type || 'N/A'}</td>
    </tr>
  `;
                },
                onTableInit: function (dtRef) {
                    dataTableRef = dtRef;
                }
            });

            $('#createBtn').on('click', function () {
                event.preventDefault();
                window.location.href = 'publicpetitions-create.html';
            });

            $('#clearStatusBtn').on('click', function (event) {
                event.preventDefault();
                $('#P29_STATUS').val('');
                dataTableRef
                    .column(3)
                    .search('')
                    .draw();
            });

        });

    </script>
</body>

</html>