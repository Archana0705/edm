<!DOCTYPE html>
<html class="no-js  page-51 app-E-DISTRICT-MANAGER-APPLICATION" lang="en">

<head>
  <meta http-equiv="x-ua-compatible" content="IE=edge" />
  <meta charset="utf-8">
  <title>Operators Details Entry</title>
  <link rel="stylesheet" href="../assets/css/oj-redwood-notag-min.css" type="text/css">
  <link rel="stylesheet" href="../assets/css/Core.min.css" type="text/css">
  <link rel="stylesheet" href="../assets/css/Theme-Standard.min.css" type="text/css">
  <link rel="stylesheet" href="../assets/css/font-apex.min.css" type="text/css">
  <link rel="stylesheet" href="../assets/css/Core-theme.min.css" type="text/css">
  <link rel="stylesheet" href="../assets/css/custom.min.css" type="text/css">
  <link rel="stylesheet" href="../assets/css/theme.css" type="text/css">
  <link rel="stylesheet" href="../assets/css/commonMenu.css" type="text/css">
  <link href="../assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <link href="../assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
  <link href="../assets/vendor/datatable/css/dataTables.css" rel="stylesheet">
  <link rel="stylesheet" href="../assets/vendor/datatable/dataTables.bootstrap5.min.css">
  <!-- Vendor CSS Files -->
  <link href="../assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <link href="../assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">

  <link href="../assets/vendor/toastr/toastr.min.css" rel="stylesheet">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Expires" content="-1" />
  <meta http-equiv="Cache-Control" content="no-cache" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    #t_Body_nav {
      width: 100% !important;
    }
  </style>
</head>

<body
  class="t-PageBody t-PageBody--hideLeft t-PageBody--hideActions no-anim t-PageTemplate--standard   apex-side-nav apex-icons-fontapex apex-theme-vita-copy-1"
  id="t_PageBody">
  <a href="#main" id="t_Body_skipToContent">Skip to Main Content</a>
  <form>
    <header class="t-Header" id="t_Header" role="banner">

      <div class="t-Header-branding">
        <div class="t-Header-controls">
          <button class="t-Button t-Button--icon t-Button--header t-Button--headerTree" aria-label="Main Navigation"
            title="Main Navigation" id="t_Button_navControl" type="button"><span class="t-Header-controlsIcon"
              aria-hidden="true"></span></button>
        </div>
        <div class="t-Header-logo">
          <a href="&#x2F;ords&#x2F;r&#x2F;edmdev&#x2F;e-district-manager-application&#x2F;home?session=114048261149373"
            class="t-Header-logo-link"><span class="apex-logo-text">e-District Manager Portal</span></a>

        </div>
        <div class="t-Header-navBar">
          <div class="t-Header-navBar--start"></div>
          <div id="globalHeader"></div>
          <div class="t-Header-navBar--end"></div>
        </div>
      </div>
      <div class="t-Header-nav"></div>
    </header>
    <div class="t-Body">
      <div class="t-Body-nav" id="t_Body_nav" role="navigation" aria-label="Application">
        <div class="a-TreeView t-TreeNav js-addActions js-defaultCollapsed js-navCollapsed--hidden t-TreeNav--classic"
          id="t_TreeNav" data-id="51_tree" aria-label="Main Navigation">
          <ul id="commonMenuContainer"></ul>
        </div>
      </div>
      <div class="t-Body-main">
        <div class="t-Body-title" id="t_Body_title"></div>
        <div class="t-Body-content" id="t_Body_content">
          <main id="main" class="t-Body-mainContent">
            <span id="APEX_SUCCESS_MESSAGE" data-template-id="35568072940746088_S"
              class="apex-page-success u-hidden"></span><span id="APEX_ERROR_MESSAGE"
              data-template-id="35568072940746088_E" class="apex-page-error u-hidden"></span>
            <div class="t-Body-fullContent"></div>
            <div class="t-Body-contentInner">
              <div class="container">
                <div class="row ">
                  <div class="col col-12 apex-col-auto col-start col-end">
                    <div
                      class="t-Region t-Region--removeHeader js-removeLandmark t-Region--noUI t-Region--scrollBody t-Form--leftLabels"
                      id="R74216798417849602" role="region" aria-label="New">
                      <div class="t-Region-header">
                        <div class="t-Region-headerItems t-Region-headerItems--title">
                          <span class="t-Region-headerIcon"><span class="t-Icon " aria-hidden="true"></span></span>
                          <h2 class="t-Region-title" id="R74216798417849602_heading" data-apex-heading>New</h2>
                        </div>
                        <div class="t-Region-headerItems t-Region-headerItems--buttons"><span
                            class="js-maximizeButtonContainer"></span></div>
                      </div>
                      <div class="t-Region-bodyWrap">
                        <div class="t-Region-buttons t-Region-buttons--top">
                          <div class="t-Region-buttons-left"></div>
                          <div class="t-Region-buttons-right"></div>
                        </div>
                        <div class="t-Region-body">
                          <div class="t-Region-orderBy"></div>
                          <input type="hidden" name="P51_ID" id="P51_ID" value=""><input type="hidden" data-for="P51_ID"
                            value="BM6w_MmYf5PhImqlJDrjZTbWG6LJKB-HyLU_IgvJ_MunyBdaqsC6XMpJ3bCF3SFOCZK8LsdNAHUI8V4ihfFb2w">
                          <div class="container">
                            <div class="row ">
                              <div class="col col-6 apex-col-auto col-start">
                                <div
                                  class="t-Form-fieldContainer rel-col t-Form-fieldContainer--stretchInputs t-Form-fieldContainer--large apex-item-wrapper apex-item-wrapper--has-initial-value apex-item-wrapper--display-only"
                                  id="P51_ESEVAI_ID_CONTAINER">
                                  <div class="t-Form-labelContainer col col-2">
                                    <label for="P51_ESEVAI_ID" id="P51_ESEVAI_ID_LABEL" class="t-Form-label">Esevai
                                      Id</label>
                                  </div>
                                  <div class="t-Form-inputContainer col col-4">
                                    <div class="t-Form-itemWrapper"><input type="hidden" id="P51_ESEVAI_ID"
                                        name="P51_ESEVAI_ID" value="TNTACCUD003-01"><input type="hidden"
                                        data-for="P51_ESEVAI_ID"
                                        value="_5Kv0K4YNOuina7KWxXpQfrXiN6bFfKJB6K_LJW4bbf5WgFjHPF0Q5GK6l1u3HAJzkzYSVs0DN6JswusEKzZOw"><span
                                        id="P51_ESEVAI_ID_DISPLAY" class="display_only&#x20;apex-item-display-only"
                                        data-escape="true">TNTACCUD003-01</span></div><span
                                      id="P51_ESEVAI_ID_error_placeholder" class="a-Form-error"
                                      data-template-id="8676686131964195_ET"></span>
                                  </div>
                                </div>
                              </div>
                              <div class="col col-6 apex-col-auto col-end">
                                <div
                                  class="t-Form-fieldContainer rel-col t-Form-fieldContainer--stretchInputs t-Form-fieldContainer--large apex-item-wrapper apex-item-wrapper--has-initial-value apex-item-wrapper--text-field"
                                  id="P51_AGENCYC_ODE_CONTAINER">
                                  <div class="t-Form-labelContainer col col-2">
                                    <label for="P51_AGENCYC_ODE" id="P51_AGENCYC_ODE_LABEL" class="t-Form-label">Agencyc
                                      Ode</label>
                                  </div>
                                  <div class="t-Form-inputContainer col col-4">
                                    <div class="t-Form-itemWrapper"><input type="text" id="P51_AGENCYC_ODE"
                                        name="P51_AGENCYC_ODE" class="text_field&#x20;apex-item-text"
                                        value="TAC [Tamil Nadu Arasu Cable TV Corporation]" size="30" maxlength="255"
                                        data-enter-submit="false" data-is-page-item-type="true" /></div><span
                                      id="P51_AGENCYC_ODE_error_placeholder" class="a-Form-error"
                                      data-template-id="8676686131964195_ET"></span>
                                  </div>
                                </div>
                              </div>
                            </div>
                            <div class="row ">
                              <div class="col col-6 apex-col-auto col-start">
                                <div
                                  class="t-Form-fieldContainer rel-col t-Form-fieldContainer--stretchInputs t-Form-fieldContainer--large apex-item-wrapper apex-item-wrapper--has-initial-value apex-item-wrapper--text-field"
                                  id="P51_NAME_CONTAINER">
                                  <div class="t-Form-labelContainer col col-2">
                                    <label for="P51_NAME" id="P51_NAME_LABEL" class="t-Form-label">Name</label>
                                  </div>
                                  <div class="t-Form-inputContainer col col-4">
                                    <div class="t-Form-itemWrapper"><input type="text" id="P51_NAME" name="P51_NAME"
                                        class="text_field&#x20;apex-item-text" value="Person name" size="30"
                                        maxlength="200" data-enter-submit="false" data-is-page-item-type="true" /></div>
                                    <span id="P51_NAME_error_placeholder" class="a-Form-error"
                                      data-template-id="8676686131964195_ET"></span>
                                  </div>
                                </div>
                              </div>
                              <div class="col col-6 apex-col-auto col-end">
                                <div
                                  class="t-Form-fieldContainer rel-col t-Form-fieldContainer--stretchInputs t-Form-fieldContainer--large apex-item-wrapper apex-item-wrapper--has-initial-value apex-item-wrapper--number-field"
                                  id="P51_MOBILENO_CONTAINER">
                                  <div class="t-Form-labelContainer col col-2">
                                    <label for="P51_MOBILENO" id="P51_MOBILENO_LABEL"
                                      class="t-Form-label">Mobileno</label>
                                  </div>
                                  <div class="t-Form-inputContainer col col-4">
                                    <div class="t-Form-itemWrapper"><input type="text" id="P51_MOBILENO"
                                        name="P51_MOBILENO"
                                        class="number_field&#x20;apex-item-text&#x20;apex-item-number&#x20;u-textStart"
                                        value="8012735864" size="30" inputmode="decimal" /></div><span
                                      id="P51_MOBILENO_error_placeholder" class="a-Form-error"
                                      data-template-id="8676686131964195_ET"></span>
                                  </div>
                                </div>
                              </div>
                            </div>
                            <div class="row ">
                              <div class="col col-6 apex-col-auto col-start">
                                <div
                                  class="t-Form-fieldContainer rel-col t-Form-fieldContainer--stretchInputs t-Form-fieldContainer--large apex-item-wrapper apex-item-wrapper--has-initial-value apex-item-wrapper--textarea"
                                  id="P51_CENTRE_ADDRESS_CONTAINER">
                                  <div class="t-Form-labelContainer col col-2">
                                    <label for="P51_CENTRE_ADDRESS" id="P51_CENTRE_ADDRESS_LABEL"
                                      class="t-Form-label">Centre Address</label>
                                  </div>
                                  <div class="t-Form-inputContainer col col-4">
                                    <div class="t-Form-itemWrapper">
                                      <div class="apex-item-group apex-item-group--textarea"><textarea
                                          name="P51_CENTRE_ADDRESS" rows="5" cols="30" maxlength="350"
                                          id="P51_CENTRE_ADDRESS" class="textarea&#x20;apex-item-textarea"
                                          data-resizable="true">68A,Reddiyar street,Annavalli,Cuddalore,607003</textarea>
                                      </div>
                                    </div><span id="P51_CENTRE_ADDRESS_error_placeholder" class="a-Form-error"
                                      data-template-id="8676686131964195_ET"></span>
                                  </div>
                                </div>
                              </div>
                              <div class="col col-6 apex-col-auto col-end">
                                <div
                                  class="t-Form-fieldContainer rel-col t-Form-fieldContainer--stretchInputs t-Form-fieldContainer--large apex-item-wrapper apex-item-wrapper--has-initial-value apex-item-wrapper--text-field"
                                  id="P51_EMAIL_CONTAINER">
                                  <div class="t-Form-labelContainer col col-2">
                                    <label for="P51_EMAIL" id="P51_EMAIL_LABEL" class="t-Form-label">Email</label>
                                  </div>
                                  <div class="t-Form-inputContainer col col-4">
                                    <div class="t-Form-itemWrapper"><input type="text" id="P51_EMAIL" name="P51_EMAIL"
                                        class="text_field&#x20;apex-item-text" value="csccuddalore@gmail.com" size="30"
                                        maxlength="255" data-enter-submit="false" data-is-page-item-type="true" /></div>
                                    <span id="P51_EMAIL_error_placeholder" class="a-Form-error"
                                      data-template-id="8676686131964195_ET"></span>
                                  </div>
                                </div>
                              </div>
                            </div>
                            <div class="row ">
                              <div class="col col-6  col-start">
                                <div
                                  class="t-Form-fieldContainer rel-col t-Form-fieldContainer--stretchInputs t-Form-fieldContainer--large apex-item-wrapper apex-item-wrapper--has-initial-value plugin-be.ctb.select2"
                                  id="P51_DISTRICT_NAME_CONTAINER">
                                  <div class="t-Form-labelContainer col col-2">
                                    <label for="P51_DISTRICT_NAME" id="P51_DISTRICT_NAME_LABEL"
                                      class="t-Form-label">District Name</label>
                                  </div>
                                  <div class="t-Form-inputContainer col col-4">
                                    <div class="t-Form-itemWrapper">
                                      <select id="P51_DISTRICT_NAME" name="P51_DISTRICT_NAME" class="selectlist ">
                                        <option value="">--Select District -- </option>
                                        <option value="Ariyalur">Ariyalur</option>
                                        <option value="Chengalpattu">Chengalpattu</option>
                                        <option value="Chennai">Chennai</option>
                                        <option value="Coimbatore">Coimbatore</option>
                                        <option value="Cuddalore" selected="selected">Cuddalore</option>
                                        <option value="Dharmapuri">Dharmapuri</option>
                                        <option value="Dindigul">Dindigul</option>
                                        <option value="Erode">Erode</option>
                                        <option value="Kallakurichi">Kallakurichi</option>
                                        <option value="Kanchipuram">Kanchipuram</option>
                                        <option value="Kanyakumari">Kanyakumari</option>
                                        <option value="Karur">Karur</option>
                                        <option value="Krishnagiri">Krishnagiri</option>
                                        <option value="Madurai">Madurai</option>
                                        <option value="Mayiladuthurai">Mayiladuthurai</option>
                                        <option value="Nagappattinam">Nagappattinam</option>
                                        <option value="Namakkal">Namakkal</option>
                                        <option value="Perambalur">Perambalur</option>
                                        <option value="Pudukkottai">Pudukkottai</option>
                                        <option value="Ramanathapuram">Ramanathapuram</option>
                                        <option value="Ranipet">Ranipet</option>
                                        <option value="Salem">Salem</option>
                                        <option value="Sivagangai">Sivagangai</option>
                                        <option value="Tenkasi">Tenkasi</option>
                                        <option value="Thanjavur">Thanjavur</option>
                                        <option value="Nilgiris">Nilgiris</option>
                                        <option value="Theni">Theni</option>
                                        <option value="Thirupattur">Thirupattur</option>
                                        <option value="Thoothukudi">Thoothukudi</option>
                                        <option value="Tiruchirappalli">Tiruchirappalli</option>
                                        <option value="Tirunelveli">Tirunelveli</option>
                                        <option value="Tiruppur">Tiruppur</option>
                                        <option value="Tiruvallur">Tiruvallur</option>
                                        <option value="Tiruvannamalai">Tiruvannamalai</option>
                                        <option value="Tiruvarur">Tiruvarur</option>
                                        <option value="Vellore">Vellore</option>
                                        <option value="Viluppuram">Viluppuram</option>
                                        <option value="Virudhunagar">Virudhunagar</option>
                                      </select>
                                    </div><span id="P51_DISTRICT_NAME_error_placeholder" class="a-Form-error"
                                      data-template-id="8676686131964195_ET"></span>
                                  </div>
                                </div>
                              </div>
                            </div>
                            <div class="row ">
                              <div class="col col-6  col-start">
                                <div
                                  class="t-Form-fieldContainer rel-col t-Form-fieldContainer--stretchInputs t-Form-fieldContainer--large apex-item-wrapper apex-item-wrapper--has-initial-value plugin-be.ctb.select2"
                                  id="P51_TALUK_NAME_CONTAINER">
                                  <div class="t-Form-labelContainer col col-2">
                                    <label for="P51_TALUK_NAME" id="P51_TALUK_NAME_LABEL" class="t-Form-label">District
                                      Name</label>
                                  </div>
                                  <div class="t-Form-inputContainer col col-4">
                                    <div class="t-Form-itemWrapper">
                                      <select id="P51_TALUK_NAME" name="P51_TALUK_NAME" class="selectlist ">
                                        <option value="">--Select Taluk -- </option>
                                      </select>
                                    </div><span id="P51_TALUK_NAME_error_placeholder" class="a-Form-error"
                                      data-template-id="8676686131964195_ET"></span>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                          <div class="t-Region-buttons t-Region-buttons--bottom">
                            <div class="t-Region-buttons-left"></div>
                            <div class="t-Region-buttons-right"></div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <div class="row ">
                <div class="col col-9  col-start"><span class="apex-grid-nbsp">&nbsp;</span></div>
                <div class="col col-2  ">
                  <button
                    class="t-Button t-Button--icon t-Button--large t-Button--success t-Button--iconLeft t-Button--hot"
                    id="saveBtn"><span class="t-Icon t-Icon--left fa fa-save fa-anim-flash"
                      aria-hidden="true"></span><span class="t-Button-label">Save
                      Petition</span><span class="t-Icon t-Icon--right fa fa-save fa-anim-flash"
                      aria-hidden="true"></span></button>
                </div>
              </div>
          </main>
          <!-- <footer class="t-Footer" id="t_Footer" role="contentinfo">
        <div class="t-Footer-body">
          <div class="t-Footer-content"></div>
          <div class="t-Footer-apex">
            <div class="t-Footer-version"> </div>
            <div class="t-Footer-customize"></div>
            
          </div>
        </div>
        <div class="t-Footer-top">
          <a href="#top" class="t-Footer-topButton" id="t_Footer_topButton" title="Start of page" aria-label="Start of page"><span class="a-Icon icon-up-chevron" aria-hidden="true"></span></a>
        </div>
      </footer> -->
        </div>
      </div>
    </div>
    <div class="t-Body-inlineDialogs" id="t_Body_inlineDialogs"></div><input type="hidden" id="pPageFormRegionChecksums"
      value="&#x5B;&#x5D;">
    <input type="hidden" id="pPageItemsRowVersion" value="" /><input type="hidden" id="pPageItemsProtected"
      value="UDUxX0lEOlA1MV9FU0VWQUlfSUQ&#x2F;U3y1zQxQbfdVfVjy9gE7qdMWME1FLa6QVnFK8tG9rU1PifqBU0T-nkSSSsXdZjec9vnsNoCNyCU_qEWwb8S3UQ" />
  </form>



  <!-- jQuery -->
  <script src="../assets/js/jquery-3.6.0.min.js"></script>
  <script src="../assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

  <!-- DataTables -->
  <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
  <script src="../assets/js/widget.treeView.min.js"></script>
  <script src="../assets/js/commonMenu.js"></script>
  <script src="../assets/js/widget.interactiveReport.min.js"></script>
  <script src="../assets/js/widget.iconList.min.js"></script>
  <script src="../assets/js/widget.stickyTableHeader.min.js"></script>
  <script src="../assets/js/widget.stickyWidget.min.js"></script>
  <script src="../assets/js/item.Colorpicker.min.js"></script>
  <script src="../assets/js/jetCommonBundle.min.js"></script>
  <script src="../assets/js/chartBundle.min.js"></script>
  <script src="../assets/js/toastUtil.js"></script>
  <script src="../assets/js/dataTableUtil.js"></script>
  <script src="../assets/js/crypto-js.min.js"></script>
  <script src="../assets/js/theme42.min.js"></script>
  <script src="../assets/js/global.js"></script>
  <script src="../assets/js/encrypt_decrypt.js"></script>
  <script src="../assets/js/globalHeader.js"></script>
  <script src="../assets/js/singleFileUpload.js"></script>

  <script>
    $(document).ready(function () {
      console.log('jQuery loaded?', typeof jQuery !== 'undefined');
      console.log('DataTable loaded?', typeof $.fn.DataTable !== 'undefined'); // should be true

      $('#pressReleaseTable').DataTable();
    });
  </script>

  <script>
    console.log("✅ DataTables loaded?", typeof $.fn.DataTable); 
  </script>
  <script>
    $('#t_Button_navControl').on('click', function () {
      $('#t_Body_nav').toggle();
    });

  </script>


  <script>
    import { encryptData, decryptData } from '../assets/js/encrypt_decrypt.js';
    import { processFile, checkFile, renderFileList } from '../assets/js/singleFileUpload.js';

    $(document).ready(function () {
      debugger

      var userId = localStorage.getItem('userId');
      const langSwitch = 'en';
      const apiUrl = "https://tngis.tnega.org/lcap_api/edm/v1/commonfunction";
      const secretKey = 'V7gN4dY8pT2xB3kRz';
      let details = '';
      let status = '';
      const urlParams = new URLSearchParams(window.location.search);
      const encodedDetails = urlParams.get('details');

      // Decode from base64
      const decodedDetailsStr = atob(encodedDetails);

      // // // Parse JSON string
      const decodedDetails = JSON.parse(decodedDetailsStr);

      // Now you can access properties
      console.log(decodedDetailsStr, "decoded status");

      // Store the taluk for later binding
      const preselectedTaluk = decodedDetails.taluk_name;

      // Set form values
      $('#P51_ESEVAI_ID_DISPLAY').text(decodedDetails.esevai_id);
      $('#P51_NAME').val(decodedDetails.name);
      $('#P51_CENTRE_ADDRESS').val(decodedDetails.centre_address);
      $('#P51_DISTRICT_NAME').val(decodedDetails.district_name);
      $('#P51_AGENCYC_ODE').val(decodedDetails.agency_code);
      $('#P51_MOBILENO').val(decodedDetails.mobileno);
      $('#P51_EMAIL').val(decodedDetails.email);

      // ✅ Bind the change handler FIRST
      $('#P51_DISTRICT_NAME').on('change', function () {
        const selectedDistrict = $(this).val();

        if (!selectedDistrict) {
          $('#P51_TALUK_NAME').html('<option value="">--Select Taluk--</option>');
          return;
        }

        const talukPayload = {
          action: "function_call",
          function_name: "taluk_edm_fn",
          params: {
            p_district_name: selectedDistrict,
            p_dummy: null
          }
        };

        $.ajax({
          url: apiUrl,
          method: "POST",
          headers: {
            'X-APP-Key': "edm",
            'X-APP-Name': "edm"
          },
          data: {
            data: encryptData(talukPayload)
          },
          dataType: 'json',
          cache: false,
          success: function (response) {
            try {
              if (response && response.data) {
                const decryptedTaluks = decryptData(response.data);

                if (!Array.isArray(decryptedTaluks)) {
                  throw new Error("Taluk list is not an array");
                }

                let options = '<option value="">--Select Taluk--</option>';
                decryptedTaluks.forEach(taluk => {
                  options += `<option value="${taluk.taluk_name}">${taluk.taluk_name}</option>`;
                });

                $('#P51_TALUK_NAME').html(options);

                // ✅ Preselect the taluk
                if (preselectedTaluk) {
                  $('#P51_TALUK_NAME').val(preselectedTaluk);
                }

              } else {
                console.error("Missing `data` in taluk response");
              }
            } catch (err) {
              console.error("Error processing taluk list:", err);
            }
          },
          error: function (xhr, status, error) {
            console.error("Taluk API failed:", {
              status: xhr.status,
              statusText: xhr.statusText,
              responseText: xhr.responseText,
              error: error
            });
          }
        });
      });

      $('#P51_DISTRICT_NAME').trigger('change');

      $('#saveBtn').on('click', function () {
        event.preventDefault();

        var P_esevai_id = $('#P51_ESEVAI_ID_DISPLAY').text();
        var p_CENTRE_ADDRESS = $('#P51_CENTRE_ADDRESS').val();
        var p_AGENCY_CODE = $('#P51_AGENCYC_ODE').val();
        var p_DISTRICT_NAME = $('#P51_DISTRICT_NAME').val();
        var p_TALUK_NAME = $('#P51_TALUK_NAME').val();
        var p_NAME = $('#P51_NAME').val();
        var p_MOBILENO = $('#P51_MOBILENO').val();
        var p_EMAIL = $('#P51_EMAIL').val();
        var p_updated_by = userId;

        var payload = {
          action: "function_call",
          function_name: "upt_master_operator_fn",
          params: {
            P_esevai_id: P_esevai_id,
            p_CENTRE_ADDRESS: p_CENTRE_ADDRESS,
            p_AGENCY_CODE: p_AGENCY_CODE,
            p_DISTRICT_NAME: p_DISTRICT_NAME,
            p_TALUK_NAME: p_TALUK_NAME,
            p_NAME: p_NAME,
            p_MOBILENO: p_MOBILENO,
            p_EMAIL: p_EMAIL,
            p_updated_by: userId
          }
        }
        console.log(payload)
        $.ajax({
          url: apiUrl,
          method: "POST",
          headers: {
            'X-APP-Key': "edm",
            'X-APP-Name': "edm"
          },
          data: {
            data: encryptData(payload)
          },
          dataType: 'json',
          cache: false,
          success: function (response) {
            const decryptedData = decryptData(response.data);
            console.log("Raw API response:", decryptedData);
            const message = decryptedData[0]?.upt_master_operator_fn || "Saved successfully.";

            showSuccessToast(message);
            // $('#P51_CENTRE_ADDRESS').val('');
            // $('#P51_AGENCYC_ODE').val('');
            // $('#P51_DISTRICT_NAME').val('');
            // $('#P51_TALUK_NAME').val('');
            // $('#P51_NAME').val('');
            // $('#P51_MOBILENO').val('');
            // $('#P51_EMAIL').val('');
            setTimeout(() => {
              window.location.href = 'operator-details.html';
            }, 1500);
          },
          error: function (xhr, status, error) {
            console.error("API call failed:", {
              status: xhr.status,
              statusText: xhr.statusText,
              responseText: xhr.responseText,
              error: error
            });
          }
        });

      });

      $('#exitBtn').on('click', function (event) {
        event.preventDefault();
        event.stopPropagation();
        // setTimeout(() => {
        //   window.location.href = "re-opened-request.html";
        // }, 10000)
        window.location.href = 'allrequest.html';
      });
    })



  </script>



</body>

</html>