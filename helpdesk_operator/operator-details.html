<!DOCTYPE html>
<html class="no-js  page-50 app-E-DISTRICT-MANAGER-APPLICATION" lang="en">

<head>
  <meta http-equiv="x-ua-compatible" content="IE=edge" />
  <meta charset="utf-8">
  <title>Operators Details</title>
  <link rel="stylesheet" href="../assets/css/oj-redwood-notag-min.css" type="text/css">
  <link rel="stylesheet" href="../assets/css/Core.min.css" type="text/css">
  <link rel="stylesheet" href="../assets/css/Theme-Standard.min.css" type="text/css">
  <link rel="stylesheet" href="../assets/css/font-apex.min.css" type="text/css">
  <link rel="stylesheet" href="../assets/css/Core-theme.min.css" type="text/css">
  <link rel="stylesheet" href="../assets/css/custom.min.css" type="text/css">
  <link rel="stylesheet" href="../assets/css/theme.css" type="text/css">
  <link rel="stylesheet" href="../assets/css/commonMenu.css" type="text/css">
  <link href="../assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <link href="../assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
  <link href="../assets/vendor/datatable/css/dataTables.css" rel="stylesheet">
  <link rel="stylesheet" href="../assets/vendor/datatable/dataTables.bootstrap5.min.css">
  <link href="../assets/vendor/toastr/toastr.min.css" rel="stylesheet">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Expires" content="-1" />
  <meta http-equiv="Cache-Control" content="no-cache" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    #t_Body_nav {
      width: 100% !important;
    }
  </style>
</head>

<body
  class="t-PageBody t-PageBody--hideLeft t-PageBody--hideActions no-anim t-PageTemplate--standard   apex-side-nav apex-icons-fontapex apex-theme-vita-copy-1"
  id="t_PageBody">
  <a href="#main" id="t_Body_skipToContent">Skip to Main Content</a>
  <form>
    <header class="t-Header" id="t_Header" role="banner">

      <div class="t-Header-branding">
        <div class="t-Header-controls">
          <button class="t-Button t-Button--icon t-Button--header t-Button--headerTree" aria-label="Main Navigation"
            title="Main Navigation" id="t_Button_navControl" type="button"><span class="t-Header-controlsIcon"
              aria-hidden="true"></span></button>
        </div>
        <div class="t-Header-logo">
          <a href="&#x2F;ords&#x2F;r&#x2F;edmdev&#x2F;e-district-manager-application&#x2F;home?session=114230090361743"
            class="t-Header-logo-link"><span class="apex-logo-text">e-District Manager Portal</span></a>

        </div>
        <div class="t-Header-navBar">
          <div class="t-Header-navBar--start"></div>
          <div id="globalHeader"></div>
          <div class="t-Header-navBar--end"></div>
        </div>
      </div>
      <div class="t-Header-nav"></div>
    </header>
    <div class="t-Body">
      <div class="t-Body-nav" id="t_Body_nav" role="navigation" aria-label="Application">
        <div class="a-TreeView t-TreeNav js-addActions js-defaultCollapsed js-navCollapsed--hidden t-TreeNav--classic"
          id="t_TreeNav" data-id="50_tree" aria-label="Main Navigation">
          <ul id="commonMenuContainer"></ul>
        </div>
      </div>
      <div class="t-Body-main">
        <div class="t-Body-title" id="t_Body_title"></div>
        <div class="t-Body-content" id="t_Body_content">
          <main id="main" class="t-Body-mainContent">
            <span id="APEX_SUCCESS_MESSAGE" data-template-id="35568072940746088_S"
              class="apex-page-success u-hidden"></span><span id="APEX_ERROR_MESSAGE"
              data-template-id="35568072940746088_E" class="apex-page-error u-hidden"></span>
            <div class="t-Body-fullContent"></div>
            <div class="t-Body-contentInner">
              <div class="container">
                <div class="row ">
                  <div class="col col-12 apex-col-auto col-start col-end">
                    <div id="R74218392229849618" role="region" aria-label="Operators&#x20;Details"
                      class="t-IRR-region ">
                      <div class="t-Region-orderBy"></div>

                      <div id="R74218392229849618_ir" class="a-IRR-container">
                        <div id="R74218392229849618_worksheet_region" class="a-IRR" aria-live="polite">
                          <div id="R74218392229849618_single_row_view" class="a-IRR-singleRowView"></div>
                          <div id="R74218392229849618_full_view" class="a-IRR-fullView">
                            <div id="R74218392229849618_actions_menu"></div>
                            <div id="R74218392229849618_column_search_drop" class="a-IRR-colSearch"></div>
                            <div id="R74218392229849618_toolbar" class="a-IRR-toolbar">
                              <div role="search" aria-label="Search&#x20;bar&#x20;of&#x20;Operators&#x20;Details"
                                id="R74218392229849618_toolbar_controls" class="a-IRR-controls">
                                <div class="a-IRR-controlGroup a-IRR-controlGroup--search">
                                  <div class="a-IRR-search"><input type="hidden"
                                      id="R74218392229849618_column_search_current_column" />
                                    <div class="a-IRR-colSelector"><button id="R74218392229849618_column_search_root"
                                        data-menu="R74218392229849618_column_search_drop"
                                        class="a-Button a-IRR-button a-IRR-button--colSearch a-Button--withIcon a-Button--noLabel"
                                        title="Select&#x20;columns&#x20;to&#x20;search"
                                        aria-label="Select&#x20;columns&#x20;to&#x20;search" type="button"><span
                                          class="a-Icon icon-search" aria-hidden="true"></span><span
                                          class="a-Icon icon-menu-drop-down" aria-hidden="true"></span></button></div>
                                    <div class="a-IRR-searchFieldContainer"><input class="a-IRR-search-field"
                                        id="R74218392229849618_search_field" title="Search Report" type="search"
                                        size="30" maxlength="4000" value="" /></div>
                                    <div class="a-IRR-searchButtonContainer"><button
                                        id="R74218392229849618_search_button"
                                        class="a-Button a-IRR-button a-IRR-button--search"
                                        type="button"><span>Go</span></button></div>
                                  </div>
                                </div>
                                <div class="a-IRR-controlGroup a-IRR-controlGroup--views"></div>
                                <div class="a-IRR-controlGroup a-IRR-controlGroup--options"><input type="hidden"
                                    id="R74218392229849618_row_select" value="50" />
                                  <div class="a-IRR-actions"><button id="R74218392229849618_actions_button"
                                      class="a-Button a-IRR-button a-IRR-button--actions" type="button"
                                      data-menu="R74218392229849618_actions_menu">Actions<span aria-hidden="true"
                                        class="a-Icon icon-menu-drop-down"></span></button></div>
                                </div>
                              </div>
                            </div>
                            <div id="R74218392229849618_content" class="a-IRR-content ">
                              <div id="R74218392229849618_dialog_js" class="a-IRR-dialogBody" style="display:none;">
                              </div><input type="hidden" id="R74218392229849618_worksheet_id"
                                value="74218460151849619" />
                              <input type="hidden" id="R74218392229849618_app_user" value="9344712827" />
                              <input type="hidden" id="R74218392229849618_report_id" value="74445473179070520" />
                              <input type="hidden" id="R74218392229849618_view_mode" value="REPORT" />
                              <style nonce="lLH-NN40dONNcFC0JpTw-Q" id="R74218392229849618_worksheet_css">
                              </style>
                              <div role="region" aria-label="Chart&#x20;view&#x20;of&#x20;Operators&#x20;Details"
                                id="R74218392229849618_chart" class="a-IRR-chartView"></div>
                              <div role="region"
                                aria-label="Group&#x20;by&#x20;view&#x20;of&#x20;Operators&#x20;Details"
                                id="R74218392229849618_group_by" class="a-IRR-groupByView"></div>
                              <div role="region" aria-label="Pivot&#x20;view&#x20;of&#x20;Operators&#x20;Details"
                                id="R74218392229849618_pivot" class="a-IRR-pivotView"></div>
                              <div role="region" aria-label="Data&#x20;view&#x20;of&#x20;Operators&#x20;Details"
                                id="R74218392229849618_data_panel" class="a-IRR-reportView">
                                <div class="a-IRR-tableContainer">
                                  <table id="pressReleaseTable" class="display" style="width:100%">
                                    <thead>
                                      <tr>
                                        <th>Esevai Id</th>
                                        <th>Centre Address</th>
                                        <th>District Name</th>
                                        <th>Taluk Name</th>
                                        <th>Name</th>
                                        <th>Mobile Number</th>
                                        <th>Email</th>
                                      </tr>
                                    </thead>
                                    <tbody></tbody>
                                  </table>
                                </div>
                                <div role="region" aria-label="Pagination&#x20;of&#x20;Operators&#x20;Details"
                                  class="a-IRR-paginationWrap a-IRR-paginationWrap--bottom">
                                  <ul class="a-IRR-pagination">
                                    <li aria-hidden="true" class="a-IRR-pagination-item is-disabled"></li>
                                    <li class="a-IRR-pagination-item"><span class="a-IRR-pagination-label"> 1 -
                                        50</span></li>
                                    <li class="a-IRR-pagination-item"><button type="button"
                                        class="a-Button a-IRR-button a-IRR-button--pagination"
                                        aria-controls="R74218392229849618" title="Next" aria-label="Next"
                                        data-pagination="pgR_min_row=51max_rows=50rows_fetched=50"><span
                                          class="a-Icon icon-right-chevron" aria-hidden="true"></span></button></li>
                                  </ul>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                        <div role="dialog" aria-label="Column&#x20;Actions" aria-modal="true" class="a-IRR-sortWidget"
                          id="R74218392229849618_sort_widget" style="display:none;">
                          <h1 class="u-vh" aria-roledescription="Visually&#x20;hidden&#x20;dialog&#x20;title">Column
                            Actions</h1>
                          <ul role="toolbar" class="a-IRR-sortWidget-actions"
                            id="R74218392229849618_sort_widget_actions">
                            <li role="none" class="a-IRR-sortWidget-actions-item"
                              id="R74218392229849618_sort_widget_action_up"><button
                                class="a-Button a-IRR-button a-IRR-sortWidget-button" type="button"
                                title="Sort&#x20;Ascending" aria-label="Sort&#x20;Ascending" data-option="up"><span
                                  aria-hidden="true" class="a-Icon icon-irr-sort-asc"></span></button></li>
                            <li role="none" class="a-IRR-sortWidget-actions-item"
                              id="R74218392229849618_sort_widget_action_down"><button
                                class="a-Button a-IRR-button a-IRR-sortWidget-button" type="button"
                                title="Sort&#x20;Descending" aria-label="Sort&#x20;Descending" data-option="down"><span
                                  aria-hidden="true" class="a-Icon icon-irr-sort-desc"></span></button></li>
                            <li role="none" class="a-IRR-sortWidget-actions-item"
                              id="R74218392229849618_sort_widget_action_hide"><button
                                class="a-Button a-IRR-button a-IRR-sortWidget-button" type="button"
                                title="Hide&#x20;Column" aria-label="Hide&#x20;Column" data-option="hide"><span
                                  aria-hidden="true" class="a-Icon icon-irr-remove-col"></span></button></li>
                            <li role="none" class="a-IRR-sortWidget-actions-item"
                              id="R74218392229849618_sort_widget_action_break"><button
                                class="a-Button a-IRR-button a-IRR-sortWidget-button" type="button"
                                title="Control&#x20;Break" aria-label="Control&#x20;Break" data-option="break"><span
                                  aria-hidden="true" class="a-Icon icon-irr-control-break"></span></button></li>
                            <li role="none" class="a-IRR-sortWidget-actions-item"
                              id="R74218392229849618_sort_widget_action_help"><button
                                class="a-Button a-IRR-button a-IRR-sortWidget-button" type="button" title="Help"
                                aria-label="Help" data-option="help" aria-pressed="false"><span aria-hidden="true"
                                  class="a-Icon icon-irr-help"></span></button></li>
                            <li role="none" class="a-IRR-sortWidget-actions-item"
                              id="R74218392229849618_sort_widget_action_computation"><button
                                class="a-Button a-IRR-button a-IRR-sortWidget-button" type="button" title="Compute"
                                aria-label="Compute" data-option="computation"><span aria-hidden="true"
                                  class="a-Icon icon-irr-calculator"></span></button></li>
                          </ul>
                          <div role="region" aria-label="Help" class="a-IRR-sortWidget-help"
                            id="R74218392229849618_sort_widget_help"></div>
                          <div role="search" class="a-IRR-sortWidget-search" id="R74218392229849618_sort_widget_search">
                            <label for="R74218392229849618_sort_widget_search_field"><span aria-hidden="true"
                                class="a-IRR-sortWidget-searchLabel"></span><span
                                class="u-vh">Search</span></label><input
                              id="R74218392229849618_sort_widget_search_field" class="a-IRR-sortWidget-searchField"
                              type="text" placeholder="Filter..." />
                            <div role="group" aria-label="Filter&#x20;suggestions" class="a-IRR-sortWidget-rows"
                              id="R74218392229849618_sort_widget_rows"></div>
                          </div>
                        </div>
                      </div>


                    </div>
                  </div>
                </div>
              </div>
            </div>
          </main>
        </div>
      </div>
    </div>
    <div class="t-Body-inlineDialogs" id="t_Body_inlineDialogs"></div><input type="hidden" id="pPageFormRegionChecksums"
      value="&#x5B;&#x5D;">
    <input type="hidden" id="pPageItemsRowVersion" value="" /><input type="hidden" id="pPageItemsProtected"
      value="&#x2F;7fq0jbM35glUY8F_YI0AP_3qriPRsyCbCQ22kOqSlJ8XQxHVfcBfHyKjZB3fBKbzUG_mYvFxkM6743bbm5Jz4Q" />
  </form>

  <!-- jQuery -->
  <script src="../assets/js/jquery-3.6.0.min.js"></script>

  <!-- DataTables -->
  <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
  <script src="../assets/js/widget.treeView.min.js"></script>
  <script type="module" src="../assets/js/commonMenu.js"></script>
  <script src="../assets/js/widget.interactiveReport.min.js"></script>
  <script src="../assets/js/widget.iconList.min.js"></script>
  <script src="../assets/js/widget.stickyTableHeader.min.js"></script>
  <script src="../assets/js/widget.stickyWidget.min.js"></script>
  <script src="../assets/js/item.Colorpicker.min.js"></script>
  <script src="../assets/js/jetCommonBundle.min.js"></script>
  <script src="../assets/js/chartBundle.min.js"></script>

  <script src="../assets/js/toastUtil.js"></script>
  <script type="module" src="../assets/js/dataTableUtil.js"></script>
  <script src="../assets/js/crypto-js.min.js"></script>
  <script src="../assets/js/theme42.min.js"></script>



  <!-- <script src="../assets/js/desktop_all.min.js"></script>
  <script src="../assets/js/theme42.min.js"></script>
  <script src="../assets/js/aos.js"></script>
  <script src="../assets/js/crypto-js.min.js"></script>
  <script type="module" src="../assets/js/commonMenu.js"></script> -->
  <!-- <script src="../assets/js/widget.treeView.min.js"></script>
  <script src="../assets/js/widget.interactiveReport.min.js"></script>
  <script src="../assets/js/widget.iconList.min.js"></script>
  <script src="../assets/js/widget.stickyTableHeader.min.js"></script>
  <script src="../assets/js/widget.stickyWidget.min.js"></script>
  <script src="../assets/js/item.Colorpicker.min.js"></script>
  <script src="../assets/js/jetCommonBundle.min.js"></script>
  <script src="../assets/js/chartBundle.min.js"></script> -->
  <script src="../assets/js/global.js"></script>
  <script src="../assets/js/encrypt_decrypt.js"></script>
  <script src="../assets/js/globalHeader.js"></script>
  <script>
    $(document).ready(function () {
      console.log('jQuery loaded?', typeof jQuery !== 'undefined');
      console.log('DataTable loaded?', typeof $.fn.DataTable !== 'undefined'); // should be true

      $('#pressReleaseTable').DataTable();
    });
  </script>

  <script>
    console.log("✅ DataTables loaded?", typeof $.fn.DataTable); 
  </script>
  <script>
    $('#t_Button_navControl').on('click', function () {
      $('#t_Body_nav').toggle();
    });

  </script>



  <script type="module">
    import { encryptData, decryptData } from '../assets/js/encrypt_decrypt.js';
    let dataTableRef;

    function initializeOperatorTable() {
      const userId = localStorage.getItem('userId');
      const p_district = localStorage.getItem('userDistrict');
      const apiUrl = "https://tngis.tnega.org/lcap_api/edm/v1/commonfunction";

      if ($.fn.DataTable.isDataTable('#pressReleaseTable')) {
        $('#pressReleaseTable').DataTable().clear().destroy();
        $('#pressReleaseTable').empty();
      }

      dataTableRef = $('#pressReleaseTable').DataTable({
        serverSide: true,
        processing: true,
        searching: false,
        ordering: false,
        pageLength: 15,
        ajax: function (data, callback) {
          const offset = data.start;
          const limit = data.length;
          // const selectedStatus = $('#P19_STATUS').val().trim();

          const payload = {
            action: "function_call",
            function_name: "operator_details_fn",
            params: {
              p_district: p_district,
              userid: userId
            },
            limit: limit,
            offset: offset,
            search: " ",
            search_key: "name"
          };

          $.ajax({
            url: apiUrl,
            method: 'POST',
            data: { data: encryptData(payload) },
            success: function (response) {
              const decrypted = decryptData(response.data);
              const totalRecords = response.pagination.total
              console.log(decrypted, "decryptData")
              callback({
                recordsTotal: totalRecords,
                recordsFiltered: totalRecords,
                data: decrypted.map(item => {
                  const applicationinfo = {
                    esevai_id: item.esevai_id,
                    centre_address: item.centre_address,
                    agency_code: item.agency_code,
                    district_name: item.district_name,
                    taluk_name: item.taluk_name,
                    name: item.name,
                    mobileno: item.mobileno,
                    email: item.email,
                  };
                  const encodedDetails = btoa(JSON.stringify(applicationinfo));

                  const esevaIdLink = item.esevai_id
                    ? `<a href="operator-detail-info.html?details=${encodedDetails}">${item.esevai_id}</a>`
                    : 'N/A';
                  return [
                    esevaIdLink,
                    item.centre_address || 'N/A',
                    item.district_name || 'N/A',
                    item.taluk_name || 'N/A',
                    item.name || 'N/A',
                    item.mobileno || 'N/A',
                    item.email || 'N/A'
                  ];
                })
              });
            },
            error: function (xhr) {
              console.error("Failed to load data:", xhr);
            }
          });
        },
        columns: [
          { title: "Esevai ID" },
          { title: "Centre Address" },
          { title: "District" },
          { title: "Taluk" },
          { title: "Name" },
          { title: "Mobile" },
          { title: "Email" }
        ]
      });
    }
    $(document).ready(function () {
      initializeOperatorTable();

      $('#statusSearchBtn').on('click', function (event) {
        event.preventDefault();
        if (dataTableRef) {
          dataTableRef.ajax.reload(); // ✅ don't reinitialize!
        }
      });

      $('#clearStatusBtn').on('click', function (event) {
        event.preventDefault();
        $('#P19_STATUS').val('');
        if (dataTableRef) {
          dataTableRef.ajax.reload(); // ✅ still don't reinitialize!
        }
      });
    });

  </script>
</body>

</html>